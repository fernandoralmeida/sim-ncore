@page
@model Sim.UI.Web.Pages.Cliente.IndexModel

@{
    ViewData["Title"] = "Clientes";
}

<partial name="_StatusMessage" model="Model.StatusMessage" />

<!--
    <div class="row white z-depth-1-half rounded-default">
        <div class="row pdn-10 mgn-b-0 right-align">
            <a class="waves-effect waves-light btn blue" asp-page="/Cliente/Novo/Index" asp-route-id="@Model.Input.RouteCPF"><i class="material-icons">person add</i></a>
            <button class="btn waves-effect waves-light" asp-page-handler="View">Pesquisar</button>
        </div>
        <div class="divider"></div>
        <div class="row mgn-b-0">
            <div class="col s12">
                <div class="input-field col s3 m3 l3">
                    <input asp-for="Input.CPF" id="inputCPF"/>
                    <label asp-for="Input.CPF"></label>
                </div>
                <div class="input-field col s9 m9 l9">
                    <input asp-for="Input.Nome"/>
                    <label asp-for="Input.Nome"></label>
                </div>
            </div>
        </div>
    </div>
-->


    <nav class="row">
        <div class="nav-wrapper">
            <ul class="col s1 m1 l1">
                <li><a asp-page="/Cliente/Novo/Index"><i class="material-icons">person add</i></a></li>
            </ul>
            <form method="post">
                <div class="input-field col s11 m11 l11">
                    <input id="search" asp-for="Input.Nome" type="search" required>
                    <label class="label-icon" for="search"><i class="material-icons">search</i></label>
                    <i class="material-icons">close</i>
                </div>
            </form>
        </div>
  </nav>

    <div class="card">
        @if (!Model.Input.ListaPessoas.Any())
        {
            if (Model.CpfValido)
            { 
                <div class="card-header">
                    <a class="waves-effect waves-light btn blue" asp-page="/Cliente/Novo/Index" asp-route-id="@Model.Input.RouteCPF"><i class="material-icons">person add</i></a>
                </div>
            }
        }
        <table class="responsive-table striped">
            <thead>
                <tr>
                    <th>
                        #
                    </th>
                    <th>
                        CPF
                    </th>
                    <th>
                        Nome
                    </th>
                    <th>
                        Tel
                    </th>
                    <th>
                        E-mail
                    </th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>

                @if (Model.Input.ListaPessoas == null)
                { }
                else
                {
                    foreach (var item in Model.Input.ListaPessoas)
                    {
                <tr>
                    <td>
                        <a asp-area="" asp-page="/Atendimento/Iniciar" asp-route-id="@item.Id" class="btn-small waves-effect" title="Iniciar atendimento"><i class="material-icons">access_time</i></a>

                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.CPF)
                    </td>
                    <td>
                        @{ var nome = item.Nome.ToUpper();
                            var email = item.Email;

                            if (email != null)
                                email = email.ToLower();
                        }

                        @Html.DisplayFor(modelItem => nome)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Tel_Movel)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => email)
                    </td>
                    <td>
                        <a asp-page="/Cliente/Manager/Index" asp-route-id="@item.Id" class="btn-small orange lighten-1 waves-effect" title="Modificar"><i class="material-icons">edit</i></a>
                    </td>
                </tr>
                    }
                }

            </tbody>
        </table>
    </div>
@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    <script src="~/js/jquery.mask.min.js"></script>
    <script>
        $('#inputCPF').mask('000.000.000-00');
    </script>
}